<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Form Validation Mithril Js</title>


    <link href="../../../line-awesome/css/line-awesome.min.css" rel="stylesheet" type="text/css">

    
        <link rel="stylesheet" href="../../../css/style.css">
    </head>

    <body>
    	<div class="main">
			<div id="sidebar" class="main-background">
    <div class="site-title">
        <h1>
            <a class="heading">
                Hi, I'm Khang
            </a>
        </h1>
    </div>
    <nav class="links">
        <a class="page-link" href="../../../about/">About</a>
        <a class="page-link" href="../../../project/">Project</a>
        <a class="page-link" href="../../../blog/">Blog</a>
    </nav>
</div>
	        <div class="common-container">
	        	

<main>
	<div class="post">
		<div class="post-info">
        <br>
        <time datetime="2020-08-08 00:00:00 &#43;0000 UTC">August 8, 2020</time>
</div>

		<h1 class="post-title">Simple Form Validation Mithril Js</h1>
<div class="post-line"></div>

		<p>Last time, I covered the basics of Mithril by creating a simple login page. In this post I will continue with form validation in a simple way.
I couldn&rsquo;t find any good tutorial covering form validation, except a snippet from <a href="https://how-to-mithril.js.org/">how-to-mithril</a>. This is my only reference for now, and I don&rsquo;t have much experience with Mithril, so this tutorial maybe not the best practice.
This time we only need to modify <code>Login.js</code> file. If you want to improve reusability, you may want to create separated file for each component.</p>
<h3 id="input-components">Input components</h3>
<p>I will create separated component for each input, first is user name.</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="kd">let</span> <span class="nx">UserNameInput</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="o">!</span><span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">?</span> <span class="s1">&#39;Please enter user name&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">isValid</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">view</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">className</span><span class="o">:</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="s1">&#39;error&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="nx">placeholder</span><span class="o">:</span> <span class="s1">&#39;User Name&#39;</span><span class="p">,</span>
                <span class="nx">value</span><span class="o">:</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;text&#39;</span><span class="p">,</span>
                <span class="nx">oninput</span><span class="o">:</span> <span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
                    <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                    <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}),</span>
            <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;div.error-message&#39;</span><span class="p">,</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
        <span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div><p>I create <code>UserNameInput</code> component by defining a <code>view</code> method. I also added <code>error</code> property to store validation result, <code>value</code> property to store input value, which I will bind to input value later.
The next two functions are pretty self-explanatory, <code>validate</code> function checks input value, while <code>isValid</code> returns validation result.
Here I implement <strong>one-way data binding</strong> from component state to view, so I can set the value of input field using <code>UserNameInput.value</code> (ie: clear input data).</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="nx">value</span><span class="o">:</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">value</span>
</code></pre></div><p>For data binding on the other direction, from view to state, I used <code>oninput</code> event, so when user types something, it will trigger the validation.</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="nx">oninput</span><span class="o">:</span> <span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
    <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
    <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
<span class="p">}</span>
</code></pre></div><p>That&rsquo;s how two-way data binding works in Mithril. This is something I really like about Mithril, just need to do a simple value assignment and we got data binding done.</p>
<p>And this line:</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;div.error-message&#39;</span><span class="p">,</span> <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
</code></pre></div><p>will show the error if validation failed.</p>
<p>Password input is pretty much the same.</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="kd">let</span> <span class="nx">PasswordInput</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">error</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">value</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
    <span class="nx">validate</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">=</span> <span class="o">!</span><span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">?</span> <span class="s1">&#39;Please enter password&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">isValid</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="kc">false</span> <span class="o">:</span> <span class="kc">true</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">view</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;input&#39;</span><span class="p">,</span> <span class="p">{</span>
                <span class="nx">className</span><span class="o">:</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">?</span> <span class="s1">&#39;error&#39;</span> <span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="nx">placeholder</span><span class="o">:</span> <span class="s1">&#39;Password&#39;</span><span class="p">,</span>
                <span class="nx">value</span><span class="o">:</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">value</span><span class="p">,</span>
                <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;password&#39;</span><span class="p">,</span>
                <span class="nx">oninput</span><span class="o">:</span> <span class="nx">e</span> <span class="p">=&gt;</span> <span class="p">{</span>
                    <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">value</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">.</span><span class="nx">value</span><span class="p">;</span>
                    <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">validate</span><span class="p">()</span>
                <span class="p">}</span>
            <span class="p">}),</span>
            <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span> <span class="o">&amp;&amp;</span> <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;div.error-message&#39;</span><span class="p">,</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span>
        <span class="p">];</span>
    <span class="p">}</span>
<span class="p">};</span>
</code></pre></div><h3 id="form-component">Form component</h3>
<p>I&rsquo;ve created all input, now I need a form to put them in.</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript">
<span class="kd">let</span> <span class="nx">LoginForm</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">isValid</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">validate</span><span class="p">();</span>
        <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">validate</span><span class="p">();</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">UserNameInput</span><span class="p">.</span><span class="nx">isValid</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">PasswordInput</span><span class="p">.</span><span class="nx">isValid</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
    <span class="p">},</span>
    <span class="nx">view</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;form&#39;</span><span class="p">,</span> <span class="p">[</span>
            <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;h1&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Login&#39;</span>
            <span class="p">),</span>
            <span class="c1">// Passing component
</span><span class="c1"></span>            <span class="nx">m</span><span class="p">(</span><span class="nx">UserNameInput</span><span class="p">),</span>
            <span class="nx">m</span><span class="p">(</span><span class="nx">PasswordInput</span><span class="p">),</span>
            <span class="nx">m</span><span class="p">(</span><span class="s1">&#39;button&#39;</span><span class="p">,</span> <span class="p">{</span>
                    <span class="kr">class</span><span class="o">:</span> <span class="s1">&#39;pure-button pure-button-primary&#39;</span><span class="p">,</span>
                    <span class="nx">id</span><span class="o">:</span> <span class="s1">&#39;loginBtn&#39;</span><span class="p">,</span>
                    <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;button&#39;</span><span class="p">,</span>
                    <span class="nx">onclick</span><span class="p">()</span> <span class="p">{</span>
                        <span class="k">if</span> <span class="p">(</span><span class="nx">LoginForm</span><span class="p">.</span><span class="nx">isValid</span><span class="p">())</span> <span class="p">{</span>
                            <span class="nx">m</span><span class="p">.</span><span class="nx">route</span><span class="p">.</span><span class="nx">set</span><span class="p">(</span><span class="s1">&#39;/dashboard&#39;</span><span class="p">)</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">},</span>
                <span class="s1">&#39;Login&#39;</span>
            <span class="p">)</span>
        <span class="p">])</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><p><code>LoginForm</code> has <code>isValid</code> function, which runs when user clicks login button.</p>
<div class="highlight"><pre class="chroma"><code class="language-JavaScript" data-lang="JavaScript"><span class="nx">m</span><span class="p">(</span><span class="nx">UserNameInput</span><span class="p">),</span>
<span class="nx">m</span><span class="p">(</span><span class="nx">PasswordInput</span><span class="p">),</span>
</code></pre></div><p>Here I pass 2 input components above to <code>LoginForm</code>, and call <code>isValid</code> function to validate our form in <code>onclick</code> event.</p>
<p>Finally, add css for validation message.</p>
<div class="highlight"><pre class="chroma"><code class="language-CSS" data-lang="CSS"><span class="p">.</span><span class="nc">login</span> <span class="nt">div</span><span class="p">.</span><span class="nc">error-message</span> <span class="p">{</span>
    <span class="k">margin</span><span class="p">:</span> <span class="mi">0</span><span class="kt">px</span> <span class="mi">25</span><span class="kt">px</span><span class="p">;</span>
    <span class="k">font-size</span><span class="p">:</span> <span class="mi">90</span><span class="kt">%</span><span class="p">;</span>
    <span class="k">color</span><span class="p">:</span> <span class="kc">red</span><span class="p">;</span>
    <span class="k">min-height</span><span class="p">:</span> <span class="mi">8</span><span class="kt">px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div><h3 id="final">Final</h3>
<p><img src="simple-form-validation-mithril-js.gif" alt="simple-form-validation-mithril-js.gif">
The validation above is pretty simple. It works but there are room for improvement:</p>
<ul>
<li>Create component for each type of validation to maximize reusability (required, length, etc)</li>
<li>Format error message with parameter</li>
</ul>
<p>And many other things. You can use this tutorial as a base for further development. Have fun with Mithril!</p>


	</div>

	<div class="pagination">
		<a href="../../../blog/2020/trying-out-mithril-js/" class="left arrow">&#8592;</a>

		<a href="#" class="top">Top</a>
	</div>
</main>


	        </div>
        </div>
    </body>
</html>
